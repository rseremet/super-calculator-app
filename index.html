<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="default">
    <title>DeshMoney –ö–∞–ª—å–∫—É–ª—è—Ç–æ—Ä</title>
    <style>
        /* ==================================== */
        /* –°—Ç–∏–ª–∏: –ö–æ—Å–º–∏—á–µ—Å–∫–∏–π —Ñ–æ–Ω –∏ Glassmorphism */
        /* ==================================== */
        :root {
            --glass-bg: rgba(255, 255, 255, 0.1);
            --glass-border: rgba(255, 255, 255, 0.2);
            --text-color: #f0f2f5;
            --accent-color: #4dc2ff; /* –Ø—Ä–∫–∏–π, –Ω–æ —Ö–æ–ª–æ–¥–Ω—ã–π —Å–∏–Ω–∏–π */
            --operator-color: #008cff; /* –ë–æ–ª–µ–µ —Ç–µ–º–Ω—ã–π —Å–∏–Ω–∏–π –¥–ª—è –æ–ø–µ—Ä–∞—Ç–æ—Ä–æ–≤ */
        }
        
        body {
            font-family: 'SF Pro Display', 'Helvetica Neue', Arial, sans-serif;
            margin: 0;
            padding: 20px;
            display: flex;
            justify-content: center;
            align-items: center;
            min-height: 100vh;
            
            /* –í–∞—à –∫–æ—Å–º–∏—á–µ—Å–∫–∏–π —Ñ–æ–Ω */
            background-image: url('image_aebac8.jpg'); /* –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ —Ñ–∞–π–ª .jpg –∑–∞–≥—Ä—É–∂–µ–Ω –≤ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π */
            background-size: cover;
            background-attachment: fixed;
            color: var(--text-color);
        }

        .container {
            width: 100%;
            max-width: 450px;
            
            /* –≠—Ñ—Ñ–µ–∫—Ç Glassmorphism */
            background: rgba(0, 0, 0, 0.5); /* –¢–µ–º–Ω—ã–π —Ñ–æ–Ω —Å –ø—Ä–æ–∑—Ä–∞—á–Ω–æ—Å—Ç—å—é */
            backdrop-filter: blur(10px); /* –†–∞–∑–º—ã—Ç–∏–µ —Ñ–æ–Ω–∞ */
            -webkit-backdrop-filter: blur(10px);
            
            border-radius: 20px;
            border: 1px solid var(--glass-border);
            box-shadow: 0 8px 32px 0 rgba(0, 0, 0, 0.37);
            padding: 30px;
        }

        h2 {
            color: var(--accent-color);
            text-align: center;
            margin-bottom: 25px;
            font-size: 2em;
        }
        
        /* –í—ã–±–æ—Ä –±–∞–∑–æ–≤–æ–π –≤–∞–ª—é—Ç—ã */
        .base-currency-select {
            display: flex;
            align-items: center;
            margin-bottom: 20px;
            color: var(--text-color);
            font-weight: 600;
        }

        #base-currency {
            flex-grow: 1;
            padding: 10px;
            margin-left: 10px;
            border-radius: 10px;
            background: rgba(255, 255, 255, 0.15);
            color: var(--text-color);
            border: 1px solid var(--glass-border);
            -webkit-appearance: none; /* –£–±—Ä–∞—Ç—å —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã–π –≤–∏–¥ –≤ Safari/Chrome */
            appearance: none;
            font-size: 1em;
        }
        
        /* –ü–æ–ª–µ –≤–≤–æ–¥–∞ */
        #input-value {
            width: 100%;
            padding: 15px;
            margin-bottom: 20px;
            font-size: 2.5em;
            text-align: right;
            border: none;
            border-radius: 10px;
            background: rgba(255, 255, 255, 0.05); /* –õ–µ–≥–∫–∏–π —ç—Ñ—Ñ–µ–∫—Ç */
            box-sizing: border-box;
            outline: none;
            color: white;
            transition: box-shadow 0.2s;
        }

        #input-value:focus {
            box-shadow: 0 0 0 3px var(--accent-color);
        }

        /* –ö–Ω–æ–ø–∫–∏ –∫–∞–ª—å–∫—É–ª—è—Ç–æ—Ä–∞ */
        .calculator-buttons {
            display: grid;
            grid-template-columns: repeat(4, 1fr);
            gap: 10px;
            margin-bottom: 30px;
        }

        .btn {
            padding: 18px 0;
            font-size: 1.3em;
            border: none;
            border-radius: 15px;
            cursor: pointer;
            transition: background-color 0.1s, transform 0.1s;
            
            /* –°—Ç–∏–ª—å Glassmorphism –¥–ª—è –∫–Ω–æ–ø–æ–∫ */
            background: var(--glass-bg);
            border: 1px solid var(--glass-border);
            color: var(--text-color);
            font-weight: 500;
        }

        .btn:active {
            transform: scale(0.95);
            background-color: rgba(255, 255, 255, 0.2);
        }

        .btn.operator {
            background-color: var(--operator-color); 
            color: white;
            font-weight: bold;
        }
        
        .btn.clear {
            background-color: #ff5e5e; /* –ö—Ä–∞—Å–Ω—ã–π –¥–ª—è –æ—á–∏—Å—Ç–∫–∏ */
            color: white;
        }

        /* –ö–æ–Ω–≤–µ—Ä—Ç–µ—Ä –≤–∞–ª—é—Ç */
        .converter {
            border-top: 1px solid var(--glass-border);
            padding-top: 20px;
        }

        .currency-result {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 12px 0;
            border-bottom: 1px solid rgba(255, 255, 255, 0.1);
            font-size: 1.1em;
        }
        
        .currency-result:last-child {
            border-bottom: none;
        }

        .currency-name {
            font-weight: 500;
            color: var(--text-color);
        }

        .currency-value {
            font-weight: 700;
            color: var(--accent-color); /* –Ø—Ä–∫–∏–π —Ü–≤–µ—Ç –¥–ª—è —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞ */
        }
        
        /* –°—Ç–∏–ª–∏ –¥–ª—è –ª–æ–∞–¥–µ—Ä–∞ */
        .loading-rates {
            text-align: center;
            color: #ffc107;
            margin-bottom: 15px;
        }
    </style>
</head>
<body>
    <div class="container">
        <h2>‚ú® DeshMoney</h2>
        
        <div class="base-currency-select">
            –ë–∞–∑–∞:
            <select id="base-currency" onchange="updateConverter(input.value)">
                <option value="USD">üá∫üá∏ –î–æ–ª–ª–∞—Ä (USD)</option>
                <option value="CNY">üá®üá≥ –Æ–∞–Ω—å (CNY)</option>
                <option value="UAH">üá∫üá¶ –ì—Ä–∏–≤–Ω–∞ (UAH)</option>
                <option value="PLN">üáµüá± –ó–ª–æ—Ç—ã–π (PLN)</option>
            </select>
        </div>
        
        <input type="text" id="input-value" value="0" readonly>

        <div class="calculator-buttons">
            <button class="btn clear" onclick="clearInput()">C</button>
            <button class="btn operator" onclick="appendInput('/')">√∑</button>
            <button class="btn operator" onclick="appendInput('*')">√ó</button>
            <button class="btn operator" onclick="calculateResult()">=</button>

            <button class="btn" onclick="appendInput('7')">7</button>
            <button class="btn" onclick="appendInput('8')">8</button>
            <button class="btn" onclick="appendInput('9')">9</button>
            <button class="btn operator" onclick="appendInput('+')">+</button>

            <button class="btn" onclick="appendInput('4')">4</button>
            <button class="btn" onclick="appendInput('5')">5</button>
            <button class="btn" onclick="appendInput('6')">6</button>
            <button class="btn operator" onclick="appendInput('-')">-</button>

            <button class="btn" onclick="appendInput('1')">1</button>
            <button class="btn" onclick="appendInput('2')">2</button>
            <button class="btn" onclick="appendInput('3')">3</button>
            <button class="btn" onclick="appendInput('.')">.</button>

            <button class="btn" onclick="appendInput('0')">0</button>
            <button class="btn" onclick="appendInput('000')">000</button>
        </div>

        <div class="converter">
            <h3>üí± –†–µ–∑—É–ª—å—Ç–∞—Ç—ã –∫–æ–Ω–≤–µ—Ä—Ç–∞—Ü–∏–∏</h3>
            <div class="loading-rates" id="loading-message">–ó–∞–≥—Ä—É–∑–∫–∞ –∞–∫—Ç—É–∞–ª—å–Ω—ã—Ö –∫—É—Ä—Å–æ–≤...</div>
            
            <div class="currency-result" data-currency="USD">
                <span class="currency-name">üá∫üá∏ –î–æ–ª–ª–∞—Ä (USD)</span>
                <span class="currency-value" id="res-usd">0.00</span>
            </div>
            
            <div class="currency-result" data-currency="CNY">
                <span class="currency-name">üá®üá≥ –Æ–∞–Ω—å (CNY)</span>
                <span class="currency-value" id="res-cny">0.00</span>
            </div>

            <div class="currency-result" data-currency="UAH">
                <span class="currency-name">üá∫üá¶ –ì—Ä–∏–≤–Ω–∞ (UAH)</span>
                <span class="currency-value" id="res-uah">0.00</span>
            </div>
            
            <div class="currency-result" data-currency="PLN">
                <span class="currency-name">üáµüá± –ó–ª–æ—Ç—ã–π (PLN)</span>
                <span class="currency-value" id="res-pln">0.00</span>
            </div>
        </div>
    </div>

    <script>
        /* ==================================== */
        /* JavaScript: –õ–æ–≥–∏–∫–∞ –ö–∞–ª—å–∫—É–ª—è—Ç–æ—Ä–∞ –∏ –ö–æ–Ω–≤–µ—Ä—Ç–µ—Ä–∞ (–ò—Å–ø—Ä–∞–≤–ª–µ–Ω–æ) */
        /* ==================================== */
        const input = document.getElementById('input-value');
        const baseCurrencySelect = document.getElementById('base-currency');
        let currentExpression = '0';
        let isResultDisplayed = false;

        // –í–ê–® API –ö–õ–Æ–ß
        const API_KEY = 'fb34ef6c5c479e7e4461d838';
        const API_URL_BASE = 'https://v6.exchangerate-api.com/v6/';

        let EXCHANGE_RATES = {}; // –¢—É—Ç –±—É–¥—É—Ç —Ö—Ä–∞–Ω–∏—Ç—å—Å—è –∞–∫—Ç—É–∞–ª—å–Ω—ã–µ –∫—É—Ä—Å—ã
        const TARGET_CURRENCIES = ['USD', 'CNY', 'UAH', 'PLN'];

        // 1. –ó–∞–ø—Ä–æ—Å –∞–∫—Ç—É–∞–ª—å–Ω—ã—Ö –∫—É—Ä—Å–æ–≤ –≤–∞–ª—é—Ç (–æ—Ç–Ω–æ—Å–∏—Ç–µ–ª—å–Ω–æ USD)
        async function fetchRates() {
            const loadingMessage = document.getElementById('loading-message');
            loadingMessage.style.display = 'block';

            try {
                const response = await fetch(`${API_URL_BASE}${API_KEY}/latest/USD`);
                const data = await response.json();

                if (data.result === 'success') {
                    EXCHANGE_RATES = data.conversion_rates;
                    loadingMessage.textContent = '–ö—É—Ä—Å—ã –æ–±–Ω–æ–≤–ª–µ–Ω—ã!';
                    loadingMessage.style.color = '#4caf50';

                    // –ö–∞–∫ —Ç–æ–ª—å–∫–æ –∫—É—Ä—Å—ã –∑–∞–≥—Ä—É–∂–µ–Ω—ã, –∑–∞–ø—É—Å–∫–∞–µ–º –∫–æ–Ω–≤–µ—Ä—Ç–∞—Ü–∏—é —Å —Ç–µ–∫—É—â–∏–º –∑–Ω–∞—á–µ–Ω–∏–µ–º
                    updateConverter(currentExpression);
                } else {
                    loadingMessage.textContent = '–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ –∫—É—Ä—Å–æ–≤. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –∫–ª—é—á API.';
                    loadingMessage.style.color = '#ff9800';
                }
            } catch (error) {
                loadingMessage.textContent = '–û—à–∏–±–∫–∞ —Å–µ—Ç–∏. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ.';
                loadingMessage.style.color = '#f44336';
                console.error("–ù–µ —É–¥–∞–ª–æ—Å—å –ø–æ–ª—É—á–∏—Ç—å –∞–∫—Ç—É–∞–ª—å–Ω—ã–µ –∫—É—Ä—Å—ã:", error);
            }
            // –°–∫—Ä—ã–≤–∞–µ–º —Å–æ–æ–±—â–µ–Ω–∏–µ —á–µ—Ä–µ–∑ 3 —Å–µ–∫—É–Ω–¥—ã, —á—Ç–æ–±—ã –æ–Ω–æ –Ω–µ –º–µ—à–∞–ª–æ
            setTimeout(() => { loadingMessage.style.display = 'none'; }, 3000);
        }


        // 2. –õ–æ–≥–∏–∫–∞ –∫–∞–ª—å–∫—É–ª—è—Ç–æ—Ä–∞
        function appendInput(value) {
            // –ï—Å–ª–∏ –æ—Ç–æ–±—Ä–∞–∂–µ–Ω —Ä–µ–∑—É–ª—å—Ç–∞—Ç –ò –Ω–∞–∂–∞—Ç–∞ —Ü–∏—Ñ—Ä–∞/—Ç–æ—á–∫–∞, –Ω–∞—á–∏–Ω–∞–µ–º –Ω–æ–≤–æ–µ –≤—ã—Ä–∞–∂–µ–Ω–∏–µ
            if (isResultDisplayed && /[0-9.]/.test(value)) {
                currentExpression = value;
                isResultDisplayed = false;
            // –ï—Å–ª–∏ –æ—Ç–æ–±—Ä–∞–∂–µ–Ω —Ä–µ–∑—É–ª—å—Ç–∞—Ç –ò –Ω–∞–∂–∞—Ç –æ–ø–µ—Ä–∞—Ç–æ—Ä, –ø—Ä–æ–¥–æ–ª–∂–∞–µ–º —Å —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–º
            } else if (isResultDisplayed && !/[0-9.]/.test(value)) {
                // –ï—Å–ª–∏ –ø–æ—Å–ª–µ '=' –Ω–∞–∂–∏–º–∞—é—Ç –æ–ø–µ—Ä–∞—Ç–æ—Ä, –∏—Å–ø–æ–ª—å–∑—É–µ–º —Ä–µ–∑—É–ª—å—Ç–∞—Ç –∫–∞–∫ –Ω–∞—á–∞–ª–æ –Ω–æ–≤–æ–≥–æ –≤—ã—Ä–∞–∂–µ–Ω–∏—è
                currentExpression = input.value.replace(/,/g, '') + value; // –£–±–∏—Ä–∞–µ–º —Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ
                isResultDisplayed = false;
            } else {
                // –û–±—ã—á–Ω—ã–π –≤–≤–æ–¥
                if (currentExpression === '0' && value !== '.') {
                    currentExpression = value;
                } else {
                    currentExpression += value;
                }
            }

            input.value = currentExpression;
            // –û–±–Ω–æ–≤–ª—è–µ–º –∫–æ–Ω–≤–µ—Ä—Ç–µ—Ä –ø—Ä–∏ –∫–∞–∂–¥–æ–º –≤–≤–æ–¥–µ
            updateConverter(currentExpression);
        }

        function clearInput() {
            currentExpression = '0';
            input.value = '0';
            isResultDisplayed = false;
            updateConverter('0');
        }

        function calculateResult() {
            try {
                // –ó–∞–º–µ–Ω—è–µ–º —Å–∏–º–≤–æ–ª—ã "√∑" –Ω–∞ "/" –∏ "√ó" –Ω–∞ "*" –¥–ª—è –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ–≥–æ eval
                const safeExpression = currentExpression.replace(/√ó/g, '*').replace(/√∑/g, '/');

                const result = eval(safeExpression);

                currentExpression = String(result);
                // –ö—Ä–∞—Å–∏–≤–æ–µ —Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –¥–ª—è –≤—ã–≤–æ–¥–∞
                input.value = result.toLocaleString('en-US', {maximumFractionDigits: 10});

                isResultDisplayed = true;
                updateConverter(result);
            } catch (e) {
                input.value = '–û—à–∏–±–∫–∞';
                currentExpression = '0';
                isResultDisplayed = true;
                updateConverter('0');
            }
        }

        // 3. –õ–æ–≥–∏–∫–∞ –∫–æ–Ω–≤–µ—Ä—Ç–µ—Ä–∞ –≤–∞–ª—é—Ç —Å —É—á–µ—Ç–æ–º –±–∞–∑–æ–≤–æ–π –≤–∞–ª—é—Ç—ã
        function updateConverter(amountStr) {
            // –ß–∏—Å—Ç–∏–º –≤–≤–æ–¥ –æ—Ç –∑–∞–ø—è—Ç—ã—Ö, —á—Ç–æ–±—ã parseFloat —Ä–∞–±–æ—Ç–∞–ª –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ
            let amount = parseFloat(String(amountStr).replace(/,/g, '')) || 0;
            const baseCurrency = baseCurrencySelect.value;

            // –ï—Å–ª–∏ –∫—É—Ä—Å—ã –µ—â–µ –Ω–µ –∑–∞–≥—Ä—É–∂–µ–Ω—ã, –ø—Ä–æ—Å—Ç–æ –æ—Ç–æ–±—Ä–∞–∂–∞–µ–º "0.00"
            if (Object.keys(EXCHANGE_RATES).length === 0) {
                 TARGET_CURRENCIES.forEach(target => {
                    const element = document.getElementById('res-' + target.toLowerCase());
                    if (element) {
                        element.textContent = '0.00';
                    }
                });
                return;
            }

            // –®–ê–ì 1: –ö–æ–Ω–≤–µ—Ä—Ç–∏—Ä—É–µ–º –≤–≤–µ–¥–µ–Ω–Ω—É—é —Å—É–º–º—É –≤ –ë–ê–ó–£ (USD)
            let amountInUSD = 0;
            if (baseCurrency === 'USD') {
                amountInUSD = amount;
            } else if (EXCHANGE_RATES[baseCurrency]) {
                // –ü–µ—Ä–µ—Å—á–∏—Ç—ã–≤–∞–µ–º –∏–∑ –±–∞–∑–æ–≤–æ–π –≤ USD
                amountInUSD = amount / EXCHANGE_RATES[baseCurrency];
            }

            // –®–ê–ì 2: –ü–µ—Ä–µ—Å—á–∏—Ç—ã–≤–∞–µ–º —Å—É–º–º—É –≤ USD –≤–æ –≤—Å–µ —Ü–µ–ª–µ–≤—ã–µ –≤–∞–ª—é—Ç—ã
            TARGET_CURRENCIES.forEach(target => {
                let finalResult = 0;

                if (target === 'USD') {
                    finalResult = amountInUSD;
                } else if (EXCHANGE_RATES[target]) {
                    finalResult = amountInUSD * EXCHANGE_RATES[target];
                }

                // –í—ã–≤–æ–¥ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞
                const element = document.getElementById('res-' + target.toLowerCase());
                if (element) {
                     // –í—ã–¥–µ–ª—è–µ–º –±–∞–∑–æ–≤—É—é –≤–∞–ª—é—Ç—É –±–µ–ª—ã–º, –æ—Å—Ç–∞–ª—å–Ω—ã–µ —Å–∏–Ω–∏–º
                     const color = (target === baseCurrency) ? 'white' : 'var(--accent-color)';
                     element.style.color = color;

                    element.textContent = finalResult.toLocaleString('en-US', {
                        minimumFractionDigits: 2,
                        maximumFractionDigits: 2
                    });
                }
            });
        }

        // –£–±–µ–¥–∏–º—Å—è, —á—Ç–æ –Ω–∞—á–∞–ª—å–Ω–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ 0 –ø—Ä–∏ –æ—á–∏—Å—Ç–∫–µ
        input.value = '0';

        // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ: –∑–∞–≥—Ä—É–∂–∞–µ–º –∫—É—Ä—Å—ã –∏ –∑–∞–ø—É—Å–∫–∞–µ–º –∫–æ–Ω–≤–µ—Ä—Ç–µ—Ä
        fetchRates();
    </script>